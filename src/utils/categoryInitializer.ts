import { Category, CategoryType } from '@/types/category';
import { categoryDB } from './indexedDB';

interface RawCategory {
  유형: '수입' | '지출';
  관: string;
  항: string;
  목: string;
}

// 실제 카테고리 데이터
const initialCategories: RawCategory[] = [
  // 수입 카테고리
  { 유형: '수입', 관: '급여', 항: '고정급여', 목: '고정급여' },
  { 유형: '수입', 관: '급여', 항: '실업급여', 목: '고용노동부' },
  { 유형: '수입', 관: '부수입', 항: '찬조비', 목: '가족' },
  { 유형: '수입', 관: '부수입', 항: '찬조비', 목: '외부' },
  { 유형: '수입', 관: '부수입', 항: '용돈', 목: '자식용돈' },
  { 유형: '수입', 관: '연금', 항: '국민연금', 목: '연금공단' },
  { 유형: '수입', 관: '연금', 항: '기초연금', 목: '보건복지부' },
  { 유형: '수입', 관: '연금', 항: '주택연금', 목: '주택공사' },
  { 유형: '수입', 관: '연금', 항: '개인연금', 목: '은행' },
  { 유형: '수입', 관: '임대료', 항: '임대료', 목: '1층카페' },
  { 유형: '수입', 관: '임대료', 항: '임대료', 목: '한일타운' },
  { 유형: '수입', 관: '기타', 항: '기타', 목: '기타' },

  // 지출 카테고리
  { 유형: '지출', 관: '건강지원비', 항: '건강보조비', 목: '건강보조비' },
  { 유형: '지출', 관: '건강지원비', 항: '건강보조비', 목: '목욕비' },
  { 유형: '지출', 관: '건강지원비', 항: '체육활동비', 목: '시설이용비' },
  { 유형: '지출', 관: '건강지원비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '경조비', 항: '노회', 목: '부의금' },
  { 유형: '지출', 관: '경조비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '관리비', 항: '연료비', 목: '전기료' },
  { 유형: '지출', 관: '관리비', 항: '영선운영비', 목: '영선비' },
  { 유형: '지출', 관: '관리비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '교통비', 항: '대중교통비', 목: '전철비' },
  { 유형: '지출', 관: '교통비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '보험료', 항: '상조비', 목: '교원라이프' },
  { 유형: '지출', 관: '보험료', 항: '생명보험', 목: '한화생명보험' },
  { 유형: '지출', 관: '보험료', 항: '실비보험', 목: '메리츠보험' },
  { 유형: '지출', 관: '보험료', 항: '실비보험', 목: '흥국화재보험' },
  { 유형: '지출', 관: '식비', 항: '부식비', 목: '식자재' },
  { 유형: '지출', 관: '식비', 항: '부식비', 목: '과일류' },
  { 유형: '지출', 관: '식비', 항: '정육비', 목: '돼지고기' },
  { 유형: '지출', 관: '식비', 항: '외식비', 목: '식사류' },
  { 유형: '지출', 관: '식비', 항: '접대비', 목: '식사류' },
  { 유형: '지출', 관: '식비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '어머니', 항: '병원비', 목: '치료비' },
  { 유형: '지출', 관: '어머니', 항: '생활비', 목: '요양원' },
  { 유형: '지출', 관: '어머니', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '의료비', 항: '병원비', 목: '이비인후과' },
  { 유형: '지출', 관: '의료비', 항: '병원비', 목: '치과' },
  { 유형: '지출', 관: '의료비', 항: '병원비', 목: '한의원' },
  { 유형: '지출', 관: '의료비', 항: '약품비', 목: '처방약품' },
  { 유형: '지출', 관: '의료비', 항: '약품비', 목: '약국약품' },
  { 유형: '지출', 관: '의료비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '의류잡비', 항: '의류비', 목: '의류비' },
  { 유형: '지출', 관: '의류잡비', 항: '잡비', 목: '잡비' },
  { 유형: '지출', 관: '의류잡비', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '자동차', 항: '공과금', 목: '자동차세' },
  { 유형: '지출', 관: '자동차', 항: '유류비', 목: '렉서스' },
  { 유형: '지출', 관: '자동차', 항: '관리비', 목: '정비료' },
  { 유형: '지출', 관: '자동차', 항: '기타', 목: '기타' },
  { 유형: '지출', 관: '통신비', 항: '이동통신', 목: '장명애' },
  { 유형: '지출', 관: '통신비', 항: '이동통신', 목: '나종춘' },
  { 유형: '지출', 관: '통신비', 항: '인터넷', 목: 'SK브로드밴드' },
  { 유형: '지출', 관: '회비', 항: '모임', 목: '가족모임' },
  { 유형: '지출', 관: '회비', 항: '모임', 목: '교회모임' },
  { 유형: '지출', 관: '회비', 항: '모임', 목: '친구모임' },
  { 유형: '지출', 관: '기타', 항: '기타', 목: '기타' }
];

export async function initializeCategories(): Promise<void> {
  try {
    await categoryDB.connect();
    const existingCategories = await categoryDB.getAllCategories();

    if (existingCategories.length === 0) {
      console.log('카테고리 초기화 시작...');
      const categories: Category[] = initialCategories.map((raw, index) => ({
        id: crypto.randomUUID(),
        type: raw.유형 === '수입' ? 'income' : 'expense' as CategoryType,
        section: raw.관,
        category: raw.항,
        subcategory: raw.목,
        order: index
      }));

      await categoryDB.replaceAllCategories(categories);
      console.log('카테고리 초기화 완료');
    } else {
      console.log('카테고리가 이미 존재합니다. 초기화를 건너뜁니다.');
    }
  } catch (error) {
    console.error('카테고리 초기화 중 오류 발생:', error);
    throw error;
  }
} 